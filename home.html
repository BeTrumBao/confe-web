<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confe </title>
    <link rel="shortcut icon" href="assets/favicon.png" type="image/x-icon">
    <meta name="google-site-verification" content="t5oQRvmsRPZ6Uz4014JmFfAFmfaQ14XoACmrDogErHg" />
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --on-primary: #ffffff;
            --primary-container: #dbeafe;
            --on-primary-container: #1e40af;
            --surface: #ffffff;
            --surface-container: #f1f5f9;
            --surface-variant: #e2e8f0;
            --outline: #cbd5e1;
            --text: #0f172a;
            --text-secondary: #64748b;
            --danger: #ef4444;
            --warn: #f59e0b;
            --radius-l: 24px;
            --radius-m: 16px;
            --radius-s: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Be Vietnam Pro', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: var(--surface-container);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .navbar {
            background: var(--surface);
            backdrop-filter: blur(12px);
            height: 64px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--outline);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .nav-logo {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            text-decoration: none;
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-right {
            display: none;
        }

        .btn-icon-nav {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
            position: relative;
        }

        .btn-icon-nav:hover {
            background: var(--surface-variant);
            color: var(--primary);
        }

        .btn-icon-nav svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .badge {
            display: none;
        }

        .nav-user {
            display: none;
        }

        .nav-avt {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            background: var(--surface-variant);
            transition: 0.2s;
        }

        .nav-avt:hover {
            transform: scale(1.05);
        }

        .dropdown-menu {
            position: absolute;
            top: 50px;
            right: 0;
            background: var(--surface);
            width: 200px;
            border-radius: var(--radius-m);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 8px;
            display: none;
            border: 1px solid var(--surface-variant);
            animation: fadeIn 0.2s ease;
        }

        .dropdown-menu.show {
            display: block;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            color: var(--text);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            border-radius: 8px;
            transition: 0.2s;
            cursor: pointer;
        }

        .menu-item:hover {
            background: var(--surface-container);
        }

        .menu-item.danger {
            color: var(--danger);
        }

        .btn-login {
            padding: 8px 20px;
            background: var(--primary);
            color: var(--on-primary);
            border-radius: 100px;
            font-weight: 600;
            text-decoration: none;
            font-size: 14px;
            transition: 0.2s;
        }

        .btn-login:hover {
            background: var(--on-primary-container);
            box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
        }

        .hero {
            padding: 40px 20px 20px;
            text-align: center;
            background: linear-gradient(180deg, var(--surface) 0%, var(--surface-container) 100%);
        }

        .hero h1 {
            font-size: 32px;
            font-weight: 800;
            color: var(--text);
            margin-bottom: 8px;
            letter-spacing: -1px;
        }

        .hero p {
            font-size: 15px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .search-wrapper {
            position: relative;
            max-width: 500px;
            margin: 0 auto;
            background: var(--surface);
            border-radius: 100px;
            box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.1);
            transition: 0.3s;
            border: 1px solid transparent;
        }

        .search-wrapper:focus-within {
            border-color: var(--primary);
            box-shadow: 0 4px 25px -5px rgba(37, 99, 235, 0.2);
        }

        .search-inp {
            width: 100%;
            padding: 14px 20px 14px 50px;
            border: none;
            background: transparent;
            font-size: 15px;
            outline: none;
            border-radius: 100px;
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            fill: var(--text-secondary);
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin: 0 0 16px 20px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
        }

        .suggest-list {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            padding: 0 5px 20px 5px;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }

        .suggest-list::-webkit-scrollbar {
            display: none;
        }

        .mini-card {
            min-width: 240px;
            height: 130px;
            border-radius: var(--radius-m);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: 0.3s;
        }

        .mini-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .mini-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .mini-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
            padding: 12px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .mini-title {
            color: white;
            font-weight: 600;
            font-size: 14px;
            line-height: 1.3;
        }

        .mini-heat {
            color: #fcd34d;
            font-size: 11px;
            font-weight: 700;
            margin-top: 4px;
        }

        .spoiler-text {
            color: transparent;
            text-shadow: 0 0 8px rgba(0, 0, 0, 0.5);
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            padding: 0 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .controls {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .chips {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: none;
            justify-content: center;
        }

        .chip {
            padding: 8px 16px;
            background: var(--surface);
            border: 1px solid var(--surface-variant);
            border-radius: 100px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            white-space: nowrap;
            transition: 0.2s;
        }

        .chip.active {
            background: var(--primary-container);
            color: var(--on-primary-container);
            border-color: var(--primary-container);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .card {
            background: var(--surface);
            border-radius: var(--radius-l);
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
            transition: 0.3s;
            cursor: pointer;
            border: 1px solid transparent;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border-color: var(--primary-container);
        }

        .card-img-box {
            height: 140px;
            position: relative;
            overflow: hidden;
            background: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
            font-weight: 700;
            font-size: 14px;
        }

        .card-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: 0.5s;
        }

        .card:hover .card-img {
            transform: scale(1.05);
        }

        .card-body {
            padding: 40px 20px 20px;
            position: relative;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .card-logo {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            border: 4px solid var(--surface);
            position: absolute;
            top: -28px;
            left: 16px;
            background: white;
            object-fit: cover;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .card-tag {
            position: absolute;
            top: 12px;
            right: 20px;
            font-size: 11px;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 6px;
            text-transform: uppercase;
            background: var(--surface-container);
            color: var(--text-secondary);
        }

        .card-badge-private {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
            color: var(--text-secondary);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            z-index: 5;
            display: flex;
            align-items: center;
            gap: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .card-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 8px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-footer {
            margin-top: auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
            border-top: 1px solid var(--surface-container);
            padding-top: 12px;
            margin-top: 12px;
        }

        .heat-tag {
            display: flex;
            align-items: center;
            gap: 4px;
            color: #f59e0b;
            background: #fffbeb;
            padding: 2px 8px;
            border-radius: 100px;
            font-weight: 700;
        }

        .btn-card-report {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 5;
            transition: 0.2s;
            color: var(--text-secondary);
            backdrop-filter: blur(4px);
        }

        .btn-card-report:hover {
            background: #fee2e2;
            color: var(--danger);
            transform: scale(1.1);
        }

        footer {
            margin-top: auto;
            padding: 40px 20px;
            text-align: center;
            background: var(--surface);
            border-top: 1px solid var(--surface-variant);
        }

        .ft-text {
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
        }

        .ft-heart {
            color: var(--danger);
            animation: heartbeat 1.5s infinite;
            display: inline-block;
        }

        .btn-feedback {
            border: none;
            background: none;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            text-decoration: underline;
            font-size: 13px;
        }

        @keyframes heartbeat {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }
        }

        .fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            background: var(--primary-container);
            color: var(--on-primary-container);
            border-radius: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            cursor: pointer;
            border: none;
            transition: 0.3s;
            z-index: 90;
        }

        @media (max-width: 768px) {
            .fab {
                bottom: 100px;

            }
        }

        .fab:hover {
            transform: scale(1.1) rotate(90deg);
            background: var(--primary);
            color: white;
        }

        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 200;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: 0.2s;
            padding: 20px;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .box {
            background: var(--surface);
            width: 100%;
            max-width: 450px;
            padding: 24px;
            border-radius: 28px;
            transform: scale(0.95);
            transition: 0.2s;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal.active .box {
            transform: scale(1);
        }

        .inp-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 6px;
        }

        .inp-area {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--outline);
            border-radius: 12px;
            font-size: 14px;
            outline: none;
            background: var(--surface);
            transition: 0.2s;
            resize: none;
        }

        .inp {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--outline);
            border-radius: 12px;
            font-size: 14px;
            outline: none;
            background: var(--surface);
            transition: 0.2s;
        }

        .inp:focus,
        .inp-area:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .btn-act {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 100px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 16px;
            font-size: 15px;
        }

        .btn-file {
            display: block;
            text-align: center;
            padding: 10px;
            border: 1px dashed var(--outline);
            border-radius: 12px;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            margin-bottom: 12px;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            background: #1e293b;
            color: white;
            padding: 10px 20px;
            border-radius: 100px;
            font-size: 13px;
            font-weight: 500;
            opacity: 0;
            transition: 0.3s;
            z-index: 1000;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .changelog-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .cl-item {
            display: flex;
            gap: 12px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--surface-variant);
        }

        .cl-item:last-child {
            border-bottom: none;
        }

        .cl-icon {
            width: 32px;
            height: 32px;
            background: var(--primary-container);
            color: var(--primary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
            font-size: 14px;
        }

        .cl-content h4 {
            font-size: 14px;
            margin-bottom: 4px;
            color: var(--text);
        }

        .cl-content p {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .cl-date {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 700;
            margin-bottom: 2px;
            text-transform: uppercase;
        }

        .skeleton {
            background: #e2e8f0;
            position: relative;
            overflow: hidden;
        }

        .skeleton::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }

            100% {
                transform: translateX(100%);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>
    <div class="hero">
        <div class="search-wrapper">
            <svg class="search-icon" viewBox="0 0 24 24">
                <path
                    d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
            </svg>
            <input type="text" id="search" class="search-inp" placeholder="T√¨m ki·∫øm topic...">
        </div>
    </div>

    <div class="container" style="padding-bottom: 0;">
        <div class="section-title"> ƒêang N·ªïi B·∫≠t</div>
        <div class="suggest-list" id="suggestList">
            <div class="mini-card skeleton" style="min-width:240px"></div>
            <div class="mini-card skeleton" style="min-width:240px"></div>
            <div class="mini-card skeleton" style="min-width:240px"></div>
        </div>
    </div>


    <div class="container">
        <div class="controls">
            <div class="chips">
                <div class="chip active" onclick="setFilter(this, 'all')">T·∫•t c·∫£</div>
                <div class="chip" onclick="setFilter(this, 'drama')"> Drama</div>
                <div class="chip" onclick="setFilter(this, 'love')">Ô∏è T√¨nh y√™u</div>
                <div class="chip" onclick="setFilter(this, 'school')"> H·ªçc ƒë∆∞·ªùng</div>
                <div class="chip" onclick="setFilter(this, 'game')"> Game</div>
            </div>
        </div>
        <div id="grid" class="grid"></div>
    </div>

    <footer>
    </footer>

    <div id="fab" class="fab">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
        </svg>
        <div id="reqBadge" class="badge"
            style="top:0; right:0; width:20px; height:20px; display:none; align-items:center; justify-content:center; color:white; font-size:10px; font-weight:bold;">
            0</div>
    </div>

    <div id="modalReport" class="modal">
        <div class="box">
            <h3 style="margin-bottom:8px;"> B√°o c√°o Topic</h3>
            <p style="font-size:13px; color:#64748b; margin-bottom:16px;">Ch·ªçn l√Ω do b·∫°n mu·ªën b√°o c√°o Topic n√†y.</p>
            <select id="rReason" class="inp" style="cursor:pointer; margin-bottom:10px;">
                <option>N·ªôi dung th√¥ t·ª•c / Ph·∫£n c·∫£m</option>
                <option>Spam / Qu·∫£ng c√°o r√°c</option>
                <option>B·∫Øt n·∫°t / Qu·∫•y r·ªëi</option>
                <option>Th√¥ng tin sai l·ªách</option>
                <option>Vi ph·∫°m b·∫£n quy·ªÅn</option>
            </select>
            <button id="btnSendReport" class="btn-act" style="background:var(--warn);">G·ª≠i B√°o C√°o</button>
            <button onclick="document.getElementById('modalReport').classList.remove('active')"
                style="width:100%; padding:12px; background:none; border:none; color:var(--text-secondary); cursor:pointer; margin-top:8px;">H·ªßy</button>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="box">
            <h3 style="margin-bottom:20px; font-size:20px;">T·∫°o Topic M·ªõi</h3>
            <div style="margin-bottom:15px"><label class="inp-label">T√™n Topic</label><input type="text" id="tTitle"
                    class="inp" placeholder="Nh·∫≠p t√™n ch·ªß ƒë·ªÅ..."></div>
            <div style="margin-bottom:15px">
                <label class="inp-label">Th·ªÉ lo·∫°i</label>
                <select id="tCat" class="inp">
                    <option value="life"> ƒê·ªùi th∆∞·ªùng</option>
                    <option value="drama"> Drama</option>
                    <option value="love">Ô∏è T√¨nh y√™u</option>
                    <option value="school"> H·ªçc ƒë∆∞·ªùng</option>
                    <option value="game"> Game</option>
                </select>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;"><label class="btn-file"> ·∫¢nh b√¨a
                    <input type="file" id="fBanner" hidden></label><label class="btn-file">Ô∏è Logo <input type="file"
                        id="fLogo" hidden></label></div>
            <div style="margin-bottom:15px"><label class="inp-label">M√¥ t·∫£ / N·ªôi quy</label><textarea id="tRules"
                    class="inp" rows="3"></textarea></div>
            <div style="display:flex; gap:15px; margin-bottom:10px;">
                <label style="font-size:13px; display:flex; align-items:center; gap:5px"><input type="checkbox"
                        id="tStatus" checked> M·ªü Topic</label>
                <label style="font-size:13px; display:flex; align-items:center; gap:5px"><input type="checkbox"
                        id="tAllowImg" checked> Cho ph√©p ·∫£nh</label>
            </div>
            <div style="margin-bottom:15px; font-size:13px; display:flex; align-items:flex-start; gap:8px;">
                <input type="checkbox" id="chkTerms" style="margin-top:3px; cursor:pointer;">
                <label for="chkTerms" style="color:var(--text-secondary); cursor:pointer;">
                    T√¥i ƒë·ªìng √Ω v·ªõi <span style="color:var(--primary); font-weight:600; text-decoration:underline;"
                        onclick="event.preventDefault(); document.getElementById('modalTerms').classList.add('active')">Quy
                        ƒë·ªãnh t·∫°o Topic</span>. T√¥i ch·ªãu tr√°ch nhi·ªám ho√†n to√†n v·ªÅ n·ªôi dung m√¨nh t·∫°o ra.
                </label>
            </div>
            <div style="display:flex; gap:10px; margin-top:20px">
                <button onclick="document.getElementById('modal').classList.remove('active')"
                    style="flex:1; padding:12px; background:var(--surface-container); border:none; border-radius:100px; font-weight:600; cursor:pointer;">H·ªßy</button>
                <button id="btnCreate" class="btn-act" style="flex:2; margin-top:0;">T·∫°o Topic</button>
            </div>
        </div>
    </div>

    <div id="modalNews" class="modal">
        <div class="box">
            <h3 style="margin-bottom:20px; font-size:20px;"> C·∫≠p nh·∫≠t m·ªõi</h3>
            <div class="changelog-list">
                <div class="cl-item">
                    <div class="cl-icon">Ô∏è</div>
                    <div class="cl-content">
                        <div class="cl-date">M·ªõi</div>
                        <h4>B·∫£o m·∫≠t Topic & Notification</h4>
                        <p>Topic ri√™ng t∆∞ v·ªõi OTP v√† Duy·ªát ng∆∞·ªùi tham gia. Th√¥ng b√°o x√©t duy·ªát ngay trang ch·ªß!</p>
                    </div>
                </div>
                <div class="cl-item">
                    <div class="cl-icon"></div>
                    <div class="cl-content">
                        <div class="cl-date">14/12</div>
                        <h4>Fix Bug V√† Th√™m T√≠nh NƒÉng M·ªõi</h4>
                        <p>H√£y t·ª± tr·∫£i nghi·ªám nh√© .</p>
                    </div>
                </div>
            </div>
            <button onclick="document.getElementById('modalNews').classList.remove('active')" class="btn-act"
                style="background:var(--surface-variant); color:var(--text);">ƒê√≥ng</button>
        </div>
    </div>
    </div>
    <div id="modalRequests" class="modal">
        <div class="box">
            <h3 style="margin-bottom:20px; font-size:20px;"> Y√™u c·∫ßu tham gia</h3>
            <p id="noReqMsg" style="text-align:center; color:#64748b; font-size:14px;">Kh√¥ng c√≥ y√™u c·∫ßu n√†o.</p>
            <div id="reqList" style="display:flex; flex-direction:column; gap:10px; max-height:400px; overflow-y:auto;">

            </div>
            <button onclick="document.getElementById('modalRequests').classList.remove('active')" class="btn-act"
                style="background:#f1f5f9; color:#475569; margin-top:20px;">ƒê√≥ng</button>
        </div>
    </div>

    <div id="modalFeedback" class="modal">
        <div class="box">
            <h3 style="margin-bottom:20px; font-size:20px;"> G√≥p √Ω cho Admin</h3>
            <div style="margin-bottom:15px"><label class="inp-label">N·ªôi dung g√≥p √Ω</label><textarea
                    id="feedbackContent" class="inp-area" rows="5" placeholder="B·∫°n mu·ªën th√™m t√≠nh nƒÉng g√¨?"></textarea>
            </div>
            <button id="btnSendFeedback" class="btn-act">G·ª≠i g√≥p √Ω</button>
            <button onclick="document.getElementById('modalFeedback').classList.remove('active')"
                style="width:100%; padding:12px; background:none; border:none; color:var(--text-secondary); cursor:pointer; margin-top:10px;">H·ªßy</button>
        </div>
    </div>

    <div id="modalTerms" class="modal" style="z-index:2000;">
        <div class="box">
            <h3 style="margin-bottom:20px;"> Quy ƒë·ªãnh T·∫°o Topic</h3>
            <div
                style="max-height:60vh; overflow-y:auto; margin-bottom:20px; font-size:14px; color:var(--text-secondary); line-height:1.6;">
                <p style="margin-bottom:10px;">1. <b>N·ªôi dung c·∫•m:</b> Kh√¥ng ƒëƒÉng t·∫£i n·ªôi dung vi ph·∫°m ph√°p lu·∫≠t, ƒë·ªìi
                    tr·ª•y, ph·∫£n ƒë·ªông, ho·∫∑c tr√°i v·ªõi thu·∫ßn phong m·ªπ t·ª•c Vi·ªát Nam.</p>
                <p style="margin-bottom:10px;">2. <b>T√¥n tr·ªçng:</b> Kh√¥ng x√∫c ph·∫°m, c√¥ng k√≠ch, qu·∫•y r·ªëi c√° nh√¢n ho·∫∑c t·ªï
                    ch·ª©c kh√°c.</p>
                <p style="margin-bottom:10px;">3. <b>Spam:</b> Kh√¥ng spam, qu·∫£ng c√°o tr√°i ph√©p, l·ª´a ƒë·∫£o.</p>
                <p style="margin-bottom:10px;">4. <b>Tr√°ch nhi·ªám:</b> Ch·ªß Topic ch·ªãu ho√†n to√†n tr√°ch nhi·ªám ph√°p l√Ω v·ªÅ
                    n·ªôi dung v√† ho·∫°t ƒë·ªông trong Topic c·ªßa m√¨nh.</p>
                <p style="margin-bottom:10px;">5. <b>Quy·ªÅn h·∫°n:</b> Admin c√≥ quy·ªÅn x√≥a Topic v√† kh√≥a t√†i kho·∫£n vƒ©nh vi·ªÖn
                    n·∫øu ph√°t hi·ªán vi ph·∫°m m√† kh√¥ng c·∫ßn b√°o tr∆∞·ªõc.</p>
            </div>
            <button onclick="document.getElementById('modalTerms').classList.remove('active')" class="btn-act">ƒê√£
                hi·ªÉu</button>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp, getDoc, doc, where, updateDoc, deleteDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const cfg = { apiKey: "AIzaSyBPEMno1uZFg4uVXZjz-PbBR37gH6-3t5Y", authDomain: "confe-web.firebaseapp.com", projectId: "confe-web", storageBucket: "confe-web.firebasestorage.app", messagingSenderId: "677778119372", appId: "1:677778119372:web:ee3f1132871332743b0069" };
        const IMG_KEY = "e6c2724ff8344c073410da4876c3d35f";

        const app = initializeApp(cfg); const auth = getAuth(app); const db = getFirestore(app);
        let user = null, allTopics = [], curFilter = 'all';
        let reportTargetId = null; // ID Topic c·∫ßn b√°o c√°o

        window.showToast = (msg) => {
            const t = document.getElementById('toast'); t.textContent = msg; t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        }

        window.openReport = (e, topicId) => {
            e.stopPropagation(); // QUAN TR·ªåNG: Ch·∫∑n s·ª± ki·ªán click lan ra ngo√†i (kh√¥ng m·ªü trang detail)
            reportTargetId = topicId;
            document.getElementById('modalReport').classList.add('active');
        }

        document.getElementById('btnSendReport').onclick = async function () {
            if (!reportTargetId) return;
            const reason = document.getElementById('rReason').value;
            this.textContent = "ƒêang g·ª≠i...";
            try {
                await addDoc(collection(db, "reports"), {
                    targetId: reportTargetId,
                    targetType: 'topic',
                    reason: reason,
                    reporter: user ? user.email : "Anonymous",
                    createdAt: serverTimestamp()
                });
                window.showToast("ƒê√£ g·ª≠i b√°o c√°o!");
                document.getElementById('modalReport').classList.remove('active');
            } catch (e) { window.showToast("L·ªói g·ª≠i b√°o c√°o!"); }
            this.textContent = "G·ª≠i B√°o C√°o";
        }

        // btnNews handler moved to updateBadge logic section below
        document.getElementById('btnSendFeedback').onclick = async () => {
            const txt = document.getElementById('feedbackContent').value;
            if (!txt) return window.showToast("B·∫°n ch∆∞a nh·∫≠p n·ªôi dung!");
            document.getElementById('btnSendFeedback').textContent = "ƒêang g·ª≠i...";
            try {
                await addDoc(collection(db, "feedbacks"), { content: txt, user: user ? user.email : "·∫®n danh", uid: user ? user.uid : null, createdAt: serverTimestamp() });
                window.showToast("C·∫£m ∆°n g√≥p √Ω c·ªßa b·∫°n! Ô∏è");
                document.getElementById('feedbackContent').value = "";
                document.getElementById('modalFeedback').classList.remove('active');
            } catch (e) { window.showToast("L·ªói khi g·ª≠i!"); }
            document.getElementById('btnSendFeedback').textContent = "G·ª≠i g√≥p √Ω";
        }

        onAuthStateChanged(auth, async (u) => {
            user = u;
            if (u) loadRequests();
            try { if (window.parent && window.parent.setUid) window.parent.setUid(u ? u.uid : null); } catch (e) { }
            const nav = document.getElementById('navAction');
            if (nav) {
                if (u) {
                    let avt = "https://via.placeholder.com/40";
                    try { const d = await getDoc(doc(db, "users", u.uid)); if (d.exists()) avt = d.data().photoURL || avt; } catch { }
                    const guestBanner = u.isAnonymous ? `
                        <a href="profile.html?uid=${u.uid}" class="menu-item" style="background:#fffbeb; border-bottom:1px solid #fde68a; color:#92400e; font-size:12px; line-height:1.4; padding:10px 14px; white-space:normal; display:block;">
                             <b>üë§ T∆∞ c√°ch kh√°ch</b><br>
                            <span style="font-weight:400;">B·∫•m ƒë·ªÉ ƒë·∫∑t email & m·∫≠t kh·∫©u l∆∞u t√†i kho·∫£n vƒ©nh vi·ªÖn</span>
                        </a>` : '';
                    nav.innerHTML = `
                        <div class="nav-user" onclick="this.querySelector('.dropdown-menu').classList.toggle('show')">
                            <img src="${avt}" class="nav-avt">
                            <div class="dropdown-menu">
                                ${guestBanner}
                                <a href="profile.html?uid=${u.uid}" class="menu-item">üë§ H·ªì s∆° c·ªßa t√¥i</a>
                                <div id="btnNavFeedback" class="menu-item">üí° G√≥p √Ω cho Admin</div>
                                <div id="btnLogout" class="menu-item danger">ƒêƒÉng xu·∫•t</div>
                            </div>
                        </div>`;
                    document.getElementById('btnNavFeedback').onclick = () => document.getElementById('modalFeedback').classList.add('active');
                    document.getElementById('btnLogout').onclick = () => signOut(auth).then(() => location.reload());
                } else { nav.innerHTML = `<a href="login.html" class="btn-login" target="_top">ƒêƒÉng nh·∫≠p</a>`; }
            }
        });

        window.onclick = (e) => {
            if (!e.target.closest('.nav-user')) document.querySelector('.dropdown-menu')?.classList.remove('show');
            if (e.target.classList.contains('modal')) e.target.classList.remove('active');
        }
        const modal = document.getElementById('modal');
        document.getElementById('fab').onclick = () => {
            if (!user) return location.href = 'login.html';
            if (user.isAnonymous) return window.showToast(' T∆∞ c√°ch kh√°ch kh√¥ng th·ªÉ t·∫°o Topic! H√£y t·∫°o t√†i kho·∫£n tr∆∞·ªõc.');
            modal.classList.add('active');
        }
        async function up(f) { if (!f) return ""; const d = new FormData(); d.append("image", f); try { return (await (await fetch(`https://api.imgbb.com/1/upload?key=${IMG_KEY}`, { method: "POST", body: d })).json()).data.url; } catch { return ""; } }

        document.getElementById('btnCreate').onclick = async function () {
            if (!user || user.isAnonymous) {
                modal.classList.remove('active');
                return window.showToast(' T∆∞ c√°ch kh√°ch kh√¥ng th·ªÉ t·∫°o Topic! H√£y t·∫°o t√†i kho·∫£n tr∆∞·ªõc.');
            }
            const t = document.getElementById('tTitle').value; if (!t) return window.showToast("Nh·∫≠p t√™n Topic!");
            if (!document.getElementById('chkTerms').checked) return window.showToast("B·∫°n ch∆∞a ƒë·ªìng √Ω quy ƒë·ªãnh!", "Ô∏è");
            this.textContent = "ƒêang t·∫°o..."; this.disabled = true;
            const b = await up(document.getElementById('fBanner').files[0]);
            const l = await up(document.getElementById('fLogo').files[0]);
            const status = document.getElementById('tStatus').checked;
            const allowImg = document.getElementById('tAllowImg').checked;
            await addDoc(collection(db, "topics"), { title: t, owner: user.email, banner: b, logo: l, category: document.getElementById('tCat').value, rules: document.getElementById('tRules').value, heat: 0, createdAt: serverTimestamp(), status: status ? 'open' : 'closed', allowImages: allowImg, postRule: 'all', is_agree_terms: true });
            window.showToast("ƒê√£ t·∫°o Topic th√†nh c√¥ng!"); modal.classList.remove('active'); this.textContent = "T·∫°o Topic"; this.disabled = false;
        };
        const grid = document.getElementById('grid');
        const suggestList = document.getElementById('suggestList');

        onSnapshot(query(collection(db, "topics"), orderBy("createdAt", "desc")), (snap) => {
            allTopics = [];
            snap.forEach(d => allTopics.push({ id: d.id, ...d.data() }));
            render();
        });

        function render() {
            const list = allTopics.filter(t => {
                const matchSearch = !document.getElementById('search').value || t.title.toLowerCase().includes(document.getElementById('search').value.toLowerCase());
                const matchCat = curFilter === 'all' || t.category === curFilter;
                return matchSearch && matchCat;
            });

            grid.innerHTML = list.map(t => {
                const isProtected = t.protectResource && (t.securityMode === 'otp' || t.securityMode === 'whitelist') && (!user || user.email !== t.owner);
                const displayTitle = isProtected ? `<span class="spoiler-text" onclick="event.stopPropagation(); window.showToast('B·∫°n ph·∫£i x√°c th·ª±c ƒë·ªÉ xem n·ªôi dung n√†y!')">N·ªôi dung ·∫©n</span>` : t.title;
                const displayBanner = isProtected ? 'https://placehold.co/600x400/e2e8f0/64748b?text=Topic+Ri√™ng+T∆∞' : (t.banner || 'https://placehold.co/600x400/e2e8f0/64748b?text=Background');
                const displayLogo = isProtected ? 'https://placehold.co/100/ffffff/64748b?text=?' : (t.logo || 'https://via.placeholder.com/50');

                return `
                <div class="card" onclick="location.href='detail.html?id=${t.id}'">
                    <button class="btn-card-report" onclick="openReport(event, '${t.id}')" title="B√°o c√°o">üö©</button>
                    ${t.securityMode === 'otp' || t.securityMode === 'whitelist' ? '<div class="card-badge-private"> Ri√™ng t∆∞</div>' : ''}
                    <div class="card-img-box">
                        <img src="${displayBanner}" class="card-img" onerror="this.style.display='none'; this.parentElement.innerText='Background'">
                    </div>
                    <div class="card-body">
                        <img src="${displayLogo}" class="card-logo">
                        <div class="card-tag">${t.category === 'love' ? 'Ô∏è T√¨nh y√™u' : t.category === 'drama' ? ' Drama' : t.category === 'school' ? ' H·ªçc ƒë∆∞·ªùng' : t.category === 'game' ? ' Game' : ' ƒê·ªùi th∆∞·ªùng'}</div>
                        <h3 class="card-title">${displayTitle}</h3>
                        <div class="card-footer">
                            <span>${t.status === 'open' ? 'üü¢' : ''}</span>
                            <div class="heat-tag"> ${t.heat || 0}</div>
                        </div>
                    </div>
                </div>
            `}).join('');

            // Render Suggestions (Top 3 Heat)
            const top = [...allTopics].sort((a, b) => (b.heat || 0) - (a.heat || 0)).slice(0, 3);
            suggestList.innerHTML = top.map(t => {
                const isProtected = t.protectResource && (t.securityMode === 'otp' || t.securityMode === 'whitelist') && (!user || user.email !== t.owner);
                const displayTitle = isProtected ? `N·ªôi dung ·∫©n` : t.title;
                const displayBanner = isProtected ? 'https://placehold.co/300x150/e2e8f0/64748b?text=Topic+Ri√™ng+T∆∞' : (t.banner || 'https://via.placeholder.com/300x150');

                return `
                 <div class="mini-card" onclick="location.href='detail.html?id=${t.id}'">
                    <img src="${displayBanner}" class="mini-img">
                    <div class="mini-overlay">
                        <div class="mini-title">${displayTitle}</div>
                        <div class="mini-heat"> ${t.heat || 0} ƒëang b√†n t√°n</div>
                    </div>
                </div>
            `}).join('');
        }

        window.setFilter = (el, cat) => {
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
            el.classList.add('active'); curFilter = cat; render();
        }
        document.getElementById('search').oninput = render;
        let pendingReqs = [];

        function loadRequests() {
            if (!user) return;
            onSnapshot(query(collection(db, "requests"), where("ownerEmail", "==", user.email), where("status", "==", "pending")), (snap) => {
                pendingReqs = [];
                snap.forEach(d => pendingReqs.push({ id: d.id, ...d.data() }));
                updateBadge();
                renderRequests();
            });
        }

        function updateBadge() {
            // Update Navbar Bell Badge
            const bellBtn = document.getElementById('btnNews');
            if (!bellBtn) return;
            const badge = bellBtn.querySelector('.badge');

            if (pendingReqs.length > 0) {
                badge.style.display = 'block';
                badge.textContent = pendingReqs.length;
                // Pulsing effect for attention
                bellBtn.style.color = 'var(--danger)';
            } else {
                badge.style.display = 'none';
                bellBtn.style.color = ''; // Reset color
            }
        }

        // Updated Bell Click Handler
        const btnNews = document.getElementById('btnNews');
        if (btnNews) {
            btnNews.onclick = () => {
                if (pendingReqs.length > 0) {
                    document.getElementById('modalRequests').classList.add('active');
                } else {
                    document.getElementById('modalNews').classList.add('active');
                }
            }
        }

        function renderRequests() {
            const list = document.getElementById('reqList');
            const msg = document.getElementById('noReqMsg');
            if (pendingReqs.length === 0) { list.innerHTML = ''; msg.style.display = 'block'; return; }
            msg.style.display = 'none';
            list.innerHTML = pendingReqs.map(r => `
                 <div style="padding:10px; border:1px solid #e2e8f0; border-radius:8px; background:white;">
                     <div style="font-weight:700; font-size:14px; margin-bottom:4px;">${r.tTitle}</div>
                     <div style="font-size:13px; color:#64748b; margin-bottom:10px;"> ${r.userName} xin tham gia</div>
                     <div style="display:flex; gap:10px;">
                         <button onclick="approveReq('${r.id}', '${r.tid}', '${r.userName}', '${r.deviceId}')" class="btn-act" style="padding:6px; font-size:12px; margin:0; flex:1;">Duy·ªát</button>
                         <button onclick="rejectReq('${r.id}')" class="btn-act" style="padding:6px; font-size:12px; margin:0; flex:1; background:#fee2e2; color:#ef4444;">T·ª´ ch·ªëi</button>
                     </div>
                 </div>
             `).join('');
        }

        window.approveReq = async (rid, tid, name, devId) => {
            // 1. Add to Whitelist in Topic
            try {
                await updateDoc(doc(db, "topics", tid), {
                    whitelist: arrayUnion({ name: name, deviceId: devId })
                });
                // 2. Update Request Status
                await updateDoc(doc(db, "requests", rid), { status: 'approved' });
                window.showToast("ƒê√£ duy·ªát th√†nh c√¥ng!");
            } catch (e) { window.showToast("L·ªói khi duy·ªát."); console.error(e); }
        }

        window.rejectReq = async (rid) => {
            try {
                await updateDoc(doc(db, "requests", rid), { status: 'rejected' });
                window.showToast("ƒê√£ t·ª´ ch·ªëi!");
            } catch (e) { window.showToast("L·ªói khi t·ª´ ch·ªëi."); }
        }

        // Modified FAB Click - Open Requests if Pending, else Create Topic
        document.getElementById('fab').onclick = () => {
            if (!user) return location.href = 'login.html';
            if (pendingReqs.length > 0) {
                document.getElementById('modalRequests').classList.add('active');
            } else {
                document.getElementById('modal').classList.add('active');
            }
        }

    </script>
</body>

</html>